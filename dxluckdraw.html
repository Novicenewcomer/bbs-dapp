<!DOCTYPE html>
<html>
	<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
        <meta name="format-detection" content="telephone=no">
        <title>德星抽奖</title>
        <link rel="stylesheet" type="text/css" href="css/public.css"/>
		<link rel="stylesheet" type="text/css" href="css/dxluckdraw.css"/>
    </head>
	<body>
		<div class="mbdivbg">
			<div class="mbdivcon">
				<div class="scrollw_box">
					<div class="scrollw_con">
						<div class="dxluckdrawbg">
							<div class="dxluckdrawtit">
								<span></span>
								<span></span>
								<span></span>
							</div>
							<div class="dxcj_trxnumlistbox">
								<ul class="dxcj_trxnumlist">
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
									<li class="dataStatistics">
										<div class="digit_set set_last"></div>
									</li>
								</ul>
								<p class="unittext">TRX</p>
							</div>
							<div class="dxcj_zhnumbox">
								<p>折合奖金：<strong></strong> CNY</p>
							</div>
							<div class="dxcj_abtnbox">
								<a href="javascript:;">抽奖规则</a><a class="openlotteryhistorybtn" href="javascritpt:;">抽奖历史</a>
							</div>
							<div class="dxcj_conwbox">
								<div class="dxcj_conbox">
									<div class="topb">
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
									</div>
									<div class="rightb">
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
									</div>
									<div class="bottomb">
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
									</div>
									<div class="leftb">
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
										<span></span>
									</div>
									<div class="jiaob">
										<span></span>
										<span></span>
										<span></span>
										<span></span>
									</div>
									<div class="dxcj_conbg">
										<ul class="dxcj_conlist">
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxcj_cjbtn">
												<div class="dxcj_cjcon">
													<p></p>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
											<li class="dxli">
												<div class="pushcon">
													<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
												</div>
												<div class="dxcon fdx300bg">
													<div class="fdx_ostar"></div>
												</div>
											</li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="choicedxflobox">
					<div class="choicedxflo">
						<div class="choicedxflocon">
							<a href="javascript:;" class="closechoicedxflobox"><svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg></a>
							<p class="tit">选择用于抽奖的德星</p>
							<ul class="cjchoice_mydx clear">
								<li itype="0">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_0"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="1">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_1"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="2">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_2"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="3">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_3"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="4">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_4"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="5">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_5"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="6">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_6"></div>
									</div>
									<span class="num"></span>
								</li>
								<li itype="7">
									<div class="con fdx300bg">
										<div class="fdx_ostar fdx_ostar_7"></div>
									</div>
									<span class="num"></span>
								</li>
							</ul>
							<div class="cjchoice_mydxico">
								<svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg>
							</div>
							<div class="cjchoice_selecteddxbox">
								<ul class="clear">
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
									<li>
										<div class="con fdx300bg">
											<div class="fdxnobg"></div>
											
										</div>
									</li>
								</ul>
								<p class="c_numtext"><strong>6</strong> / 8</p>
							</div>
							<p class="cjchoice_lucknum">预计最高抽奖额：<span></span></p>
							<a href="javascript:;" class="redbtn cjchoice_btn">确认并提交</a>
						</div>
					</div>
				</div>
				<div class="cjresultsflo cjresultsfailflo">
					<div class="cjresultsflobor">
						<div class="cjresultsflocon">
							<a href="javascript:;" class="closecjresultsflo"><svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg></a>
							<p class="tit">很遗憾</p>
							<p class="tit1">本次您没有抽中任何奖励~</p>
							<div class="textcon">
								<p class="ptit">支付 <strong>5000 FF</strong></p>
								<p>可免消耗德星重新再抽取一次，</p>
								<p>是否确定再尝试抽一次？</p>
							</div>
							<div class="cjresultsfailbtnbox clear">
								<a href="javascript:;" class="cjonemorebtn">再抽一次</a>
								<a href="javascript:;" class="cjnomorebtn">不抽了</a>
							</div>
						</div>
					</div>
				</div>
				<div class="cjresultsflo cjresultssucflo">
					<div class="cjresultsflobor">
						<div class="cjresultsflocon">
							<a href="javascript:;" class="closecjresultsflo"><svg class="icon" aria-hidden="true"><use xlink:href="#iconfanhui-h"></use></svg></a>
							<p class="tit">恭喜你获得以下奖励</p>
							<div class="textconbox">
								<div class="textcon">
									<div class="ptitbox">
										<div class="leftimgb"></div><strong></strong></div>
									<p>奖金折合：<strong class="cnynum"></strong></p>
								</div>
							</div>
							<p class="cjresultssuctext">以上奖金将直接进入八宝树资产钱包中</p>
							<div class="cjresultssucbtnbox clear">
								<a href="javascript:;">知道啦</a>
							</div>
						</div>
					</div>
					<a href="javascript:;" class="closecjresultssucflobtn"></a>
				</div>
				<div class="publoadflo"></div>
			</div>
		</div>
	</body>
	<script src="js/jquery.js"></script>
	<script src="js/jquery.dataStatistics.js"></script>
	<script src="js/public.js"></script>
	<script>
		//底部导航
		linkOpenpage.pagebottomnav=function(othis){
			othis.loadHtmlobj({
				csslink:["css/pages/pagebottomnav.css"],
				jssrc:["js/pages/pagebottomnav.js"],
				callbackfn:function(thisobj){
					pagebottomnav.init({container:othis,type:"cj"});
					pagebottomnav.thisdom.load("pagebottomnav.html",function(){
						pagebottomnav.showbox();
						thisobj.endfn();
						linkOpenpage.readpage();
					})
				}
			})
		};
		//抽奖历史
		linkOpenpage.lotteryhistory = function(othis){
	        othis.loadHtmlobj({
	            csslink:["css/pages/pagelotteryhistory.css"],
	            jssrc:["js/pages/pagelotteryhistory.js"],
	            callbackfn:function(thisobj){
	                lotteryhistoryfn.init({container:othis});
					lotteryhistoryfn.thisdom.load("pagelotteryhistory.html",function(){
						lotteryhistoryfn.showbox();
						thisobj.endfn();
						linkOpenpage.readpage();
					})
	
	            }
	        })
	    };

		$(function(){
			var instantlotteryclick = true;
			dxluckdrawfn.instantlotteryfn = function(){//立即抽奖
				if(!instantlotteryclick){
					return;
				}
				instantlotteryclick = false;
				$(".publoadflo").show();
				var data = {
					state: Math.round(Math.random()),//0没获奖 1获奖
					get:"123456",//获得TRX
					cny:"42765.00" 
				}
				//成功
				dxluckdrawfn.resetdx()
				if(data.state=="0"){
					$(".cjresultsfailbtnbox").show()
					$(".cjresultsfailflo .textcon").show()
					$(".publoadflo").fadeOut();
					$(".cjresultsfailflo").fadeIn()
				}else{
					$(".publoadflo").fadeOut();
					$(".cjresultssucflo").fadeIn();
					$(".closecjresultssucflobtn").css("top",$(".cjresultssucflo .cjresultsflobor").outerHeight(true)-$(".cjresultssucbtnbox").outerHeight()-parseFloat($(".cjresultsflobor").css("padding-bottom")))
					$(".cjresultssucflo .ptitbox strong").html(data.get+" TRX")
					$(".cjresultssucflo .cnynum").html(data.cny+" CNY")
				}
				instantlotteryclick = true;
				//失败
				// operationFailedobj.init("失败原因")
				// instantlotteryclick = true;
			}
			var onemorelotteryclick = true;
			dxluckdrawfn.onemorelotteryfn = function(){//花ff再抽抽奖
				if(!onemorelotteryclick){
					return;
				}
				onemorelotteryclick = false;
				$(".publoadflo").show();
				$(".cjresultsfailflo").hide()
				var data = {
					state:Math.round(Math.random()),//0没获奖 1获奖
					get:"123456",//获得TRX
					cny:"42765.00" 
				}
				//成功
				dxluckdrawfn.resetdx()
				if(data.state=="0"){
					$(".cjresultsfailbtnbox").hide()
					$(".cjresultsfailflo .textcon").hide()
					$(".publoadflo").fadeOut();
					$(".cjresultsfailflo").fadeIn()
				}else{
					$(".publoadflo").fadeOut();
					$(".cjresultssucflo").fadeIn();
					$(".closecjresultssucflobtn").css("top",$(".cjresultssucflo .cjresultsflobor").outerHeight(true)-$(".cjresultssucbtnbox").outerHeight()-parseFloat($(".cjresultsflobor").css("padding-bottom")))
					$(".cjresultssucflo .ptitbox strong").html(data.get+" TRX")
					$(".cjresultssucflo .cnynum").html(data.cny+" CNY")
				}
				onemorelotteryclick = true;
				//失败
				// operationFailedobj.init("失败原因")
				// onemorelotteryclick = true;
			}
			dxluckdrawfn.init({
				numdata:156356,//trx
				htrxnnum:210100.00,
				rmbnum:402765.18,//cny
				c_mydx:{//拥有德星
					"0":1,
					"1":2,
					"2":0,
					"3":6,
					"4":9,
					"5":11,
					"6":58,
					"7":100,
				}
			})
		})
		linkOpenpage.readpage({
			pagearr:["pagebottomnav"],
			othis:$(".mbdivcon")
		});
		$(".openlotteryhistorybtn").on("click",function(){
			linkOpenpage.readpage({
				pagearr:["lotteryhistory"],
				othis:$(".mbdivcon")
			});
	    })

		var dxluckdrawfn = {
			initnum:[0,0,0,0,0,0,0,0],
			thisnum:[],
			rmbnum:0,
			numdata:0,
			htrxnnum:0,
			addnum:0,
			
			c_mydx:{},
			oldc_xzdx:{},
			oldc_xzdxnum:0,
			c_xzdx:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},
			c_xzdxnum:0,
			init:function(opt){
				var _this = this;
				$.extend(this,opt);
				this.readnum();
				this.addnum = (this.rmbnum/30).toFixed(2);
				this.readrmbnum(0);
				
				$(".dxcj_conbg .dxli").on("click",function(){
					_this.choicedxfloshow();
				})
				$(".closechoicedxflobox").on("click",function(){
					$(".choicedxflobox").fadeOut();
					_this.c_xzdx =JSON.parse(JSON.stringify(_this.oldc_xzdx));
					_this.c_xzdxnum = _this.oldc_xzdxnum*1;
				})
				$(".cjchoice_mydx li").on("click",function(){
					if($(this).hasClass("hasdx")&&_this.c_xzdxnum<8){
						_this.c_xzdx[$(this).attr("itype")]++;
						_this.readxzdx();
					}
				})
				$(".cjchoice_selecteddxbox li").on("click",function(){
					if($(this).hasClass("active")){
						_this.c_xzdx[$(this).attr("itype")]--;
						_this.readxzdx();
					}
				})
				$(".cjchoice_btn").on("click",function(){
					$(".choicedxflobox").fadeOut();
					var linum = 0;
					$(".dxcj_conlist .dxli").removeClass("dxliac").removeAttr("itype").find(".fdx_ostar").attr("class","fdx_ostar")
					for(var i in _this.c_xzdx){
						if(_this.c_xzdx[i]>0){
							for(var n=0;n<_this.c_xzdx[i];n++){
								$(".dxcj_conlist .dxli").eq(linum).addClass("dxliac").attr("itype",i).find(".fdx_ostar").attr("class","fdx_ostar fdx_ostar_"+i);
								linum++
							}
						}
					}
					if(_this.c_xzdxnum>=8){
						$(".dxcj_cjbtn").addClass("dxcj_cjbtnac");
					}else{
						$(".dxcj_cjbtn").removeClass("dxcj_cjbtnac");
					}
				})
				$(".dxcj_cjbtn").on("click",function(){
					if($(this).hasClass("dxcj_cjbtnac")){
						_this.instantlotteryfn()
					}
				})
				$(".cjresultsfailflo .closecjresultsflo").on("click",function(){
					$(".cjresultsfailflo").fadeOut()
				})
				$(".cjnomorebtn").on("click",function(){
					$(".cjresultsfailflo").fadeOut()
				})
				$(".cjonemorebtn").on("click",function(){
					_this.onemorelotteryfn()
				})
				
				$('.closecjresultssucflobtn').on("click",function(){
					$(".cjresultssucflo").fadeOut()
				})
				$(".cjresultssucflo .closecjresultsflo").on("click",function(){
					$(".cjresultssucflo").fadeOut()
				})
			},
			readnum:function(){
				this.thisnum = this.numdata.toString().split("");
				for(var i=0;i<=this.initnum.length-this.thisnum.length;i++){
					this.thisnum.unshift("0")
				}
				for(var i=$(".dxcj_trxnumlist li").length-1;i>=0;i--){
					$(".dxcj_trxnumlist li").eq(i).dataStatistics({min:this.initnum[i],max:this.thisnum[i],time:3000,len:1});
				}
			},
			readrmbnum:function(num){
				var _this = this;
				
				if(num<this.rmbnum){
					$(".dxcj_zhnumbox strong").html(num);
					num = calculationObj.add(num,this.addnum);
					setTimeout(function(){
						_this.readrmbnum(num);
					},100)
				}else{
					$(".dxcj_zhnumbox strong").html(this.rmbnum);
				}
			},
			
			resetdx:function(){
				for(var i in this.c_mydx){
					this.c_mydx[i] = calculationObj.sub(this.c_mydx[i],this.c_xzdx[i])
					
				}
				$(".dxcj_conlist .dxli").removeClass("dxliac").removeAttr("itype")
				$(".dxcj_cjbtn").removeClass("dxcj_cjbtnac");
				this.c_xzdx ={"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0};
				this.c_xzdxnum = 0;
				this.readxzdx();
			},
			choicedxfloshow:function(){
				$(".choicedxflobox").fadeIn();
				this.oldc_xzdx = JSON.parse(JSON.stringify(this.c_xzdx));
				this.oldc_xzdxnum = this.c_xzdxnum*1;
				this.readxzdx();
			},
			readxzdx:function(){
				$(".cjchoice_lucknum span").html(this.htrxnnum+" TRX")
				$(".cjchoice_selecteddxbox li").removeClass("active").removeAttr("itype").find(".fdx300bg div").attr("class","fdxnobg")
				var xs = 0
				for(var i in this.c_mydx){
					xs = calculationObj.sub(this.c_mydx[i],this.c_xzdx[i])
					if(xs>0){
						$(".cjchoice_mydx li[itype='"+i+"']").addClass("hasdx").find(".num").html("x"+xs)
					}else{
						$(".cjchoice_mydx li[itype='"+i+"']").removeClass("hasdx").find(".num").html("x")
					}
				}
				this.c_xzdxnum = 0;
				var linum = 0;
				for(var i in this.c_xzdx){
					if(this.c_xzdx[i]>0){
						this.c_xzdxnum = this.c_xzdxnum + this.c_xzdx[i];
						for(var n=0;n<this.c_xzdx[i];n++){
							$(".cjchoice_selecteddxbox li").eq(linum).addClass("active").attr("itype",i)
							.find(".fdxnobg").attr("class",$(".cjchoice_mydx li[itype='"+i+"']").find(".fdx_ostar").attr("class"))
							linum++
						}
					}
				}
				$(".c_numtext strong").html(this.c_xzdxnum)
			},
			instantlotteryfn:function(){},
			onemorelotteryfn:function(){}
		}
		// 
	</script>
</html>
